/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/webhook/route";
exports.ids = ["app/api/webhook/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "http2":
/*!************************!*\
  !*** external "http2" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("http2");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "?1110":
/*!***********************!*\
  !*** debug (ignored) ***!
  \***********************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.0.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Froute&page=%2Fapi%2Fwebhook%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Froute.ts&appDir=%2FApplications%2FMAMP%2Fhtdocs%2Fshopify-cart-recovery%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FApplications%2FMAMP%2Fhtdocs%2Fshopify-cart-recovery&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.0.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Froute&page=%2Fapi%2Fwebhook%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Froute.ts&appDir=%2FApplications%2FMAMP%2Fhtdocs%2Fshopify-cart-recovery%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FApplications%2FMAMP%2Fhtdocs%2Fshopify-cart-recovery&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.0.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.0.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var _Applications_MAMP_htdocs_shopify_cart_recovery_src_app_api_webhook_route_ts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./src/app/api/webhook/route.ts */ \"(rsc)/./src/app/api/webhook/route.ts\");\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/webhook/route\",\n        pathname: \"/api/webhook\",\n        filename: \"route\",\n        bundlePath: \"app/api/webhook/route\"\n    },\n    resolvedPagePath: \"/Applications/MAMP/htdocs/shopify-cart-recovery/src/app/api/webhook/route.ts\",\n    nextConfigOutput,\n    userland: _Applications_MAMP_htdocs_shopify_cart_recovery_src_app_api_webhook_route_ts__WEBPACK_IMPORTED_MODULE_2__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/webhook/route\";\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4wLjBfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjFfX3JlYWN0QDE4LjMuMS9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ3ZWJob29rJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ3ZWJob29rJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGd2ViaG9vayUyRnJvdXRlLnRzJmFwcERpcj0lMkZBcHBsaWNhdGlvbnMlMkZNQU1QJTJGaHRkb2NzJTJGc2hvcGlmeS1jYXJ0LXJlY292ZXJ5JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZBcHBsaWNhdGlvbnMlMkZNQU1QJTJGaHRkb2NzJTJGc2hvcGlmeS1jYXJ0LXJlY292ZXJ5JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUMwQztBQUN6RztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNpSjs7QUFFakoiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaG9waWZ5LWNhcnQtcmVjb3ZlcnkvP2ViNDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL0FwcGxpY2F0aW9ucy9NQU1QL2h0ZG9jcy9zaG9waWZ5LWNhcnQtcmVjb3Zlcnkvc3JjL2FwcC9hcGkvd2ViaG9vay9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd2ViaG9vay9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3dlYmhvb2tcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3dlYmhvb2svcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvQXBwbGljYXRpb25zL01BTVAvaHRkb2NzL3Nob3BpZnktY2FydC1yZWNvdmVyeS9zcmMvYXBwL2FwaS93ZWJob29rL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3dlYmhvb2svcm91dGVcIjtcbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.0.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Froute&page=%2Fapi%2Fwebhook%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Froute.ts&appDir=%2FApplications%2FMAMP%2Fhtdocs%2Fshopify-cart-recovery%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FApplications%2FMAMP%2Fhtdocs%2Fshopify-cart-recovery&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/webhook/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/webhook/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/.pnpm/next@14.0.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_shopify__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/shopify */ \"(rsc)/./src/lib/shopify.ts\");\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _lib_cart_recovery__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/cart-recovery */ \"(rsc)/./src/lib/cart-recovery.ts\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_4__);\n\n\n\n\n\nfunction verifyWebhook(body, signature) {\n    const secret = process.env.SHOPIFY_WEBHOOK_SECRET;\n    if (!secret) return false;\n    const hash = crypto__WEBPACK_IMPORTED_MODULE_4___default().createHmac(\"sha256\", secret).update(body, \"utf8\").digest(\"base64\");\n    return hash === signature;\n}\nasync function POST(request) {\n    try {\n        const body = await request.text();\n        const signature = request.headers.get(\"x-shopify-hmac-sha256\");\n        const shopifyTopic = request.headers.get(\"x-shopify-topic\");\n        // Try to save webhook call to Supabase (don't fail if this errors)\n        try {\n            await (0,_lib_supabase__WEBPACK_IMPORTED_MODULE_2__.saveWebhookCall)(shopifyTopic || \"unknown\", JSON.parse(body), {\n                signature,\n                topic: shopifyTopic\n            });\n        } catch (logError) {\n            console.warn(\"Failed to log webhook call:\", logError);\n        }\n        // Verify webhook authenticity\n        if (!signature || !verifyWebhook(body, signature)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const webhookData = JSON.parse(body);\n        // Handle checkout webhooks (abandoned carts)\n        if (shopifyTopic === \"checkouts/create\" || shopifyTopic === \"checkouts/update\") {\n            console.log(\"Processing checkout webhook:\", shopifyTopic);\n            await _lib_cart_recovery__WEBPACK_IMPORTED_MODULE_3__.cartRecoveryService.processCheckoutWebhook(webhookData);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true\n            });\n        }\n        // Handle order webhooks (completed purchases)\n        if (shopifyTopic === \"orders/create\" || shopifyTopic === \"orders/paid\") {\n            console.log(\"Processing order webhook:\", shopifyTopic);\n            await _lib_cart_recovery__WEBPACK_IMPORTED_MODULE_3__.cartRecoveryService.processOrderWebhook(webhookData);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true\n            });\n        }\n        // Legacy cart webhook support\n        if (shopifyTopic === \"carts/create\" || shopifyTopic === \"carts/update\") {\n            const cartData = JSON.parse(body);\n            console.log(\"Processing legacy cart webhook\");\n            await (0,_lib_shopify__WEBPACK_IMPORTED_MODULE_1__.processCartWebhook)(cartData);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: true\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Invalid webhook topic\"\n        }, {\n            status: 400\n        });\n    } catch (error) {\n        console.error(\"Webhook error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Webhook processing failed\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS93ZWJob29rL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBdUQ7QUFDTDtBQUNGO0FBQ1M7QUFDOUI7QUFFM0IsU0FBU0ssY0FBY0MsSUFBWSxFQUFFQyxTQUFpQjtJQUNwRCxNQUFNQyxTQUFTQyxRQUFRQyxHQUFHLENBQUNDLHNCQUFzQjtJQUNqRCxJQUFJLENBQUNILFFBQVEsT0FBTztJQUVwQixNQUFNSSxPQUFPUix3REFBaUIsQ0FBQyxVQUFVSSxRQUFRTSxNQUFNLENBQUNSLE1BQU0sUUFBUVMsTUFBTSxDQUFDO0lBQzdFLE9BQU9ILFNBQVNMO0FBQ2xCO0FBRU8sZUFBZVMsS0FBS0MsT0FBb0I7SUFDN0MsSUFBSTtRQUNGLE1BQU1YLE9BQU8sTUFBTVcsUUFBUUMsSUFBSTtRQUMvQixNQUFNWCxZQUFZVSxRQUFRRSxPQUFPLENBQUNDLEdBQUcsQ0FBQztRQUN0QyxNQUFNQyxlQUFlSixRQUFRRSxPQUFPLENBQUNDLEdBQUcsQ0FBQztRQUV6QyxtRUFBbUU7UUFDbkUsSUFBSTtZQUNGLE1BQU1sQiw4REFBZUEsQ0FBQ21CLGdCQUFnQixXQUFXQyxLQUFLQyxLQUFLLENBQUNqQixPQUFPO2dCQUNqRUM7Z0JBQ0FpQixPQUFPSDtZQUNUO1FBQ0YsRUFBRSxPQUFPSSxVQUFVO1lBQ2pCQyxRQUFRQyxJQUFJLENBQUMsK0JBQStCRjtRQUM5QztRQUVBLDhCQUE4QjtRQUM5QixJQUFJLENBQUNsQixhQUFhLENBQUNGLGNBQWNDLE1BQU1DLFlBQVk7WUFDakQsT0FBT1Asa0ZBQVlBLENBQUM0QixJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBZSxHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDcEU7UUFFQSxNQUFNQyxjQUFjVCxLQUFLQyxLQUFLLENBQUNqQjtRQUUvQiw2Q0FBNkM7UUFDN0MsSUFBSWUsaUJBQWlCLHNCQUFzQkEsaUJBQWlCLG9CQUFvQjtZQUM5RUssUUFBUU0sR0FBRyxDQUFDLGdDQUFnQ1g7WUFDNUMsTUFBTWxCLG1FQUFtQkEsQ0FBQzhCLHNCQUFzQixDQUFDRjtZQUNqRCxPQUFPL0Isa0ZBQVlBLENBQUM0QixJQUFJLENBQUM7Z0JBQUVNLFNBQVM7WUFBSztRQUMzQztRQUVBLDhDQUE4QztRQUM5QyxJQUFJYixpQkFBaUIsbUJBQW1CQSxpQkFBaUIsZUFBZTtZQUN0RUssUUFBUU0sR0FBRyxDQUFDLDZCQUE2Qlg7WUFDekMsTUFBTWxCLG1FQUFtQkEsQ0FBQ2dDLG1CQUFtQixDQUFDSjtZQUM5QyxPQUFPL0Isa0ZBQVlBLENBQUM0QixJQUFJLENBQUM7Z0JBQUVNLFNBQVM7WUFBSztRQUMzQztRQUVBLDhCQUE4QjtRQUM5QixJQUFJYixpQkFBaUIsa0JBQWtCQSxpQkFBaUIsZ0JBQWdCO1lBQ3RFLE1BQU1lLFdBQVdkLEtBQUtDLEtBQUssQ0FBQ2pCO1lBQzVCb0IsUUFBUU0sR0FBRyxDQUFDO1lBQ1osTUFBTS9CLGdFQUFrQkEsQ0FBQ21DO1lBQ3pCLE9BQU9wQyxrRkFBWUEsQ0FBQzRCLElBQUksQ0FBQztnQkFBRU0sU0FBUztZQUFLO1FBQzNDO1FBRUEsT0FBT2xDLGtGQUFZQSxDQUFDNEIsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBd0IsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDN0UsRUFBRSxPQUFPRCxPQUFPO1FBQ2RILFFBQVFHLEtBQUssQ0FBQyxrQkFBa0JBO1FBQ2hDLE9BQU83QixrRkFBWUEsQ0FBQzRCLElBQUksQ0FBQztZQUFFQyxPQUFPO1FBQTRCLEdBQUc7WUFBRUMsUUFBUTtRQUFJO0lBQ2pGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaG9waWZ5LWNhcnQtcmVjb3ZlcnkvLi9zcmMvYXBwL2FwaS93ZWJob29rL3JvdXRlLnRzPzBlZmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgcHJvY2Vzc0NhcnRXZWJob29rIH0gZnJvbSAnQC9saWIvc2hvcGlmeSdcbmltcG9ydCB7IHNhdmVXZWJob29rQ2FsbCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlJ1xuaW1wb3J0IHsgY2FydFJlY292ZXJ5U2VydmljZSB9IGZyb20gJ0AvbGliL2NhcnQtcmVjb3ZlcnknXG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0bydcblxuZnVuY3Rpb24gdmVyaWZ5V2ViaG9vayhib2R5OiBzdHJpbmcsIHNpZ25hdHVyZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52LlNIT1BJRllfV0VCSE9PS19TRUNSRVRcbiAgaWYgKCFzZWNyZXQpIHJldHVybiBmYWxzZVxuICBcbiAgY29uc3QgaGFzaCA9IGNyeXB0by5jcmVhdGVIbWFjKCdzaGEyNTYnLCBzZWNyZXQpLnVwZGF0ZShib2R5LCAndXRmOCcpLmRpZ2VzdCgnYmFzZTY0JylcbiAgcmV0dXJuIGhhc2ggPT09IHNpZ25hdHVyZVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0LnRleHQoKVxuICAgIGNvbnN0IHNpZ25hdHVyZSA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtc2hvcGlmeS1obWFjLXNoYTI1NicpXG4gICAgY29uc3Qgc2hvcGlmeVRvcGljID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC1zaG9waWZ5LXRvcGljJylcbiAgICBcbiAgICAvLyBUcnkgdG8gc2F2ZSB3ZWJob29rIGNhbGwgdG8gU3VwYWJhc2UgKGRvbid0IGZhaWwgaWYgdGhpcyBlcnJvcnMpXG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHNhdmVXZWJob29rQ2FsbChzaG9waWZ5VG9waWMgfHwgJ3Vua25vd24nLCBKU09OLnBhcnNlKGJvZHkpLCB7XG4gICAgICAgIHNpZ25hdHVyZSxcbiAgICAgICAgdG9waWM6IHNob3BpZnlUb3BpY1xuICAgICAgfSlcbiAgICB9IGNhdGNoIChsb2dFcnJvcikge1xuICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gbG9nIHdlYmhvb2sgY2FsbDonLCBsb2dFcnJvcilcbiAgICB9XG4gICAgXG4gICAgLy8gVmVyaWZ5IHdlYmhvb2sgYXV0aGVudGljaXR5XG4gICAgaWYgKCFzaWduYXR1cmUgfHwgIXZlcmlmeVdlYmhvb2soYm9keSwgc2lnbmF0dXJlKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSlcbiAgICB9XG4gICAgXG4gICAgY29uc3Qgd2ViaG9va0RhdGEgPSBKU09OLnBhcnNlKGJvZHkpXG4gICAgXG4gICAgLy8gSGFuZGxlIGNoZWNrb3V0IHdlYmhvb2tzIChhYmFuZG9uZWQgY2FydHMpXG4gICAgaWYgKHNob3BpZnlUb3BpYyA9PT0gJ2NoZWNrb3V0cy9jcmVhdGUnIHx8IHNob3BpZnlUb3BpYyA9PT0gJ2NoZWNrb3V0cy91cGRhdGUnKSB7XG4gICAgICBjb25zb2xlLmxvZygnUHJvY2Vzc2luZyBjaGVja291dCB3ZWJob29rOicsIHNob3BpZnlUb3BpYylcbiAgICAgIGF3YWl0IGNhcnRSZWNvdmVyeVNlcnZpY2UucHJvY2Vzc0NoZWNrb3V0V2ViaG9vayh3ZWJob29rRGF0YSlcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSlcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIG9yZGVyIHdlYmhvb2tzIChjb21wbGV0ZWQgcHVyY2hhc2VzKVxuICAgIGlmIChzaG9waWZ5VG9waWMgPT09ICdvcmRlcnMvY3JlYXRlJyB8fCBzaG9waWZ5VG9waWMgPT09ICdvcmRlcnMvcGFpZCcpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdQcm9jZXNzaW5nIG9yZGVyIHdlYmhvb2s6Jywgc2hvcGlmeVRvcGljKVxuICAgICAgYXdhaXQgY2FydFJlY292ZXJ5U2VydmljZS5wcm9jZXNzT3JkZXJXZWJob29rKHdlYmhvb2tEYXRhKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KVxuICAgIH1cbiAgICBcbiAgICAvLyBMZWdhY3kgY2FydCB3ZWJob29rIHN1cHBvcnRcbiAgICBpZiAoc2hvcGlmeVRvcGljID09PSAnY2FydHMvY3JlYXRlJyB8fCBzaG9waWZ5VG9waWMgPT09ICdjYXJ0cy91cGRhdGUnKSB7XG4gICAgICBjb25zdCBjYXJ0RGF0YSA9IEpTT04ucGFyc2UoYm9keSlcbiAgICAgIGNvbnNvbGUubG9nKCdQcm9jZXNzaW5nIGxlZ2FjeSBjYXJ0IHdlYmhvb2snKVxuICAgICAgYXdhaXQgcHJvY2Vzc0NhcnRXZWJob29rKGNhcnREYXRhKVxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgd2ViaG9vayB0b3BpYycgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1dlYmhvb2sgZXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdXZWJob29rIHByb2Nlc3NpbmcgZmFpbGVkJyB9LCB7IHN0YXR1czogNTAwIH0pXG4gIH1cbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicHJvY2Vzc0NhcnRXZWJob29rIiwic2F2ZVdlYmhvb2tDYWxsIiwiY2FydFJlY292ZXJ5U2VydmljZSIsImNyeXB0byIsInZlcmlmeVdlYmhvb2siLCJib2R5Iiwic2lnbmF0dXJlIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIlNIT1BJRllfV0VCSE9PS19TRUNSRVQiLCJoYXNoIiwiY3JlYXRlSG1hYyIsInVwZGF0ZSIsImRpZ2VzdCIsIlBPU1QiLCJyZXF1ZXN0IiwidGV4dCIsImhlYWRlcnMiLCJnZXQiLCJzaG9waWZ5VG9waWMiLCJKU09OIiwicGFyc2UiLCJ0b3BpYyIsImxvZ0Vycm9yIiwiY29uc29sZSIsIndhcm4iLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJ3ZWJob29rRGF0YSIsImxvZyIsInByb2Nlc3NDaGVja291dFdlYmhvb2siLCJzdWNjZXNzIiwicHJvY2Vzc09yZGVyV2ViaG9vayIsImNhcnREYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/webhook/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/cart-recovery.ts":
/*!**********************************!*\
  !*** ./src/lib/cart-recovery.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CartRecoveryService: () => (/* binding */ CartRecoveryService),\n/* harmony export */   cartRecoveryService: () => (/* binding */ cartRecoveryService)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _vapi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./vapi */ \"(rsc)/./src/lib/vapi.ts\");\n\n\nclass CartRecoveryService {\n    // Extract phone number from various fields in the payload\n    extractPhoneNumber(payload) {\n        const phoneFields = [\n            payload.phone,\n            payload.customer?.phone,\n            payload.customer?.default_address?.phone,\n            payload.billing_address?.phone,\n            payload.shipping_address?.phone,\n            payload.sms_marketing_phone\n        ];\n        for (const phone of phoneFields){\n            if (phone && typeof phone === \"string\" && phone.trim()) {\n                return phone.trim();\n            }\n        }\n        return null;\n    }\n    // Extract customer name from payload\n    extractCustomerName(payload) {\n        const firstName = payload.customer?.first_name || payload.billing_address?.first_name || \"\";\n        const lastName = payload.customer?.last_name || payload.billing_address?.last_name || \"\";\n        const fullName = payload.customer?.default_address?.name || payload.billing_address?.name || \"\";\n        if (firstName || lastName) {\n            return `${firstName} ${lastName}`.trim();\n        }\n        if (fullName) {\n            return fullName;\n        }\n        return \"Customer\";\n    }\n    // Extract main product name from line items\n    extractMainProductName(lineItems) {\n        if (!lineItems || lineItems.length === 0) {\n            return \"Product\";\n        }\n        return lineItems[0]?.title || lineItems[0]?.presentment_title || \"Product\";\n    }\n    // Process checkout webhook and save abandoned cart if it has phone number\n    async processCheckoutWebhook(payload) {\n        const phoneNumber = this.extractPhoneNumber(payload);\n        if (!phoneNumber) {\n            console.log(\"No phone number found in checkout, skipping cart recovery\");\n            return;\n        }\n        const abandonedCart = {\n            checkout_id: payload.id,\n            token: payload.token,\n            customer_phone: phoneNumber,\n            customer_email: payload.email || payload.customer?.email,\n            customer_name: this.extractCustomerName(payload),\n            total_price: parseFloat(payload.total_price || \"0\"),\n            currency: payload.currency || \"USD\",\n            line_items: payload.line_items || [],\n            created_at: payload.created_at || new Date().toISOString()\n        };\n        const { error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"abandoned_carts\").upsert(abandonedCart, {\n            onConflict: \"token\",\n            ignoreDuplicates: false\n        });\n        if (error) {\n            console.error(\"Error saving abandoned cart:\", error);\n            throw error;\n        }\n        console.log(`Saved abandoned cart with phone: ${phoneNumber}`);\n    }\n    // Process order webhook to mark cart as completed\n    async processOrderWebhook(payload) {\n        const checkoutToken = payload.checkout_token;\n        if (!checkoutToken) {\n            console.log(\"No checkout token in order, skipping\");\n            return;\n        }\n        const orderData = {\n            order_id: payload.id,\n            checkout_token: checkoutToken,\n            customer_email: payload.email || payload.customer?.email,\n            customer_phone: payload.customer?.phone || payload.billing_address?.phone,\n            total_price: parseFloat(payload.total_price || \"0\"),\n            currency: payload.currency || \"USD\",\n            created_at: payload.created_at || new Date().toISOString(),\n            payload: payload\n        };\n        await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"orders\").upsert(orderData, {\n            onConflict: \"order_id\"\n        });\n        const { error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"abandoned_carts\").update({\n            is_completed: true,\n            completed_at: new Date().toISOString()\n        }).eq(\"token\", checkoutToken);\n        if (error) {\n            console.error(\"Error marking cart as completed:\", error);\n        } else {\n            console.log(`Marked cart ${checkoutToken} as completed`);\n        }\n    }\n    // Process all existing webhook_calls to find abandoned carts with phone numbers\n    async processAllWebhookCalls() {\n        const { data: webhooks } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"webhook_calls\").select(\"*\").in(\"topic\", [\n            \"checkouts/create\",\n            \"checkouts/update\"\n        ]);\n        for (const webhook of webhooks || []){\n            const payload = webhook.payload;\n            const phoneNumber = this.extractPhoneNumber(payload);\n            if (!phoneNumber || !payload.token) continue;\n            // Check if cart already exists\n            const { data: existingCart } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"abandoned_carts\").select(\"id\").eq(\"token\", payload.token).single();\n            if (existingCart) continue;\n            // Create cart record\n            const cartData = {\n                checkout_id: payload.id,\n                token: payload.token,\n                customer_phone: phoneNumber,\n                customer_email: payload.email || payload.customer?.email,\n                customer_name: this.extractCustomerName(payload),\n                total_price: parseFloat(payload.total_price || \"0\"),\n                currency: payload.currency || \"USD\",\n                line_items: payload.line_items || [],\n                created_at: payload.created_at || webhook.created_at\n            };\n            await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"abandoned_carts\").insert(cartData);\n            console.log(`Processed existing webhook for cart ${payload.token}`);\n        }\n    }\n    async processScheduledCalls() {\n        const now = new Date();\n        // Get all incomplete carts with phone numbers\n        const { data: carts, error } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"abandoned_carts\").select(\"*\").eq(\"is_completed\", false).not(\"customer_phone\", \"is\", null);\n        if (error) {\n            console.error(\"Error fetching abandoned carts:\", error);\n            return;\n        }\n        console.log(`Found ${carts?.length || 0} abandoned carts to process`);\n        for (const cart of carts || []){\n            console.log(`Processing cart ${cart.token}`);\n            // Get existing call log for this cart\n            let { data: callLog } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"call_logs\").select(\"*\").eq(\"abandoned_cart_id\", cart.id).single();\n            if (!callLog) {\n                console.log(`Creating call log for cart ${cart.token}`);\n                const { data: newCallLog } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"call_logs\").insert({\n                    abandoned_cart_id: cart.id,\n                    phone_number: cart.customer_phone\n                }).select().single();\n                callLog = newCallLog;\n            }\n            if (!callLog) continue;\n            // Make first available call\n            let callToMake = null;\n            let hourField = null;\n            if (callLog.call_2_hour === 0) {\n                callToMake = \"2_hour\";\n                hourField = \"call_2_hour\";\n            } else if (callLog.call_4_hour === 0) {\n                callToMake = \"4_hour\";\n                hourField = \"call_4_hour\";\n            } else if (callLog.call_8_hour === 0) {\n                callToMake = \"8_hour\";\n                hourField = \"call_8_hour\";\n            } else if (callLog.call_16_hour === 0) {\n                callToMake = \"16_hour\";\n                hourField = \"call_16_hour\";\n            } else if (callLog.call_24_hour === 0) {\n                callToMake = \"24_hour\";\n                hourField = \"call_24_hour\";\n            }\n            if (callToMake && hourField) {\n                console.log(`Making ${callToMake} call for cart ${cart.token}`);\n                await this.makeRecoveryCall(cart, callLog, callToMake, hourField);\n            } else {\n                console.log(`No calls needed for cart ${cart.token}`);\n            }\n        }\n    }\n    // Make a recovery call for a specific cart\n    async makeRecoveryCall(cart, callLog, callType, hourField) {\n        if (!cart.customer_phone) return;\n        const productName = this.extractMainProductName(cart.line_items);\n        console.log(`Making ${callType} call to ${cart.customer_phone} for cart ${cart.token}`);\n        const callResult = await _vapi__WEBPACK_IMPORTED_MODULE_1__.vapiService.makeCall(cart.customer_phone, cart.customer_name || \"Customer\", productName);\n        // Update call log with the result\n        await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"call_logs\").update({\n            [hourField]: 1,\n            vapi_response: callResult,\n            success: callResult.success\n        }).eq(\"id\", callLog.id);\n        // Also update abandoned_carts table\n        const updateTimeField = `call_${callType}_at`;\n        await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"abandoned_carts\").update({\n            [`call_${callType.replace(\"_hour\", \"_hour\")}`]: true,\n            [updateTimeField]: new Date().toISOString()\n        }).eq(\"id\", cart.id);\n        console.log(`${callType} call ${callResult.success ? \"successful\" : \"failed\"} for cart ${cart.token}`);\n    }\n    // Get daily stats\n    async getDailyStats(date) {\n        const { data: carts } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"abandoned_carts\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        const { data: calls } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"call_logs\").select(\"*\").order(\"created_at\", {\n            ascending: false\n        });\n        return {\n            totalAbandoned: carts?.length || 0,\n            totalCompleted: carts?.filter((c)=>c.is_completed).length || 0,\n            totalCalls: calls?.length || 0,\n            successfulCalls: calls?.filter((c)=>c.success).length || 0,\n            carts: carts || [],\n            calls: calls || []\n        };\n    }\n}\nconst cartRecoveryService = new CartRecoveryService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPRyxPQUFPQyxDQUFBQSxJQUFLQSxFQUFFWCxPQUFPLEVBQUVwRSxVQUFVO1lBQ3pEZ0QsT0FBT0EsU0FBUyxFQUFFO1lBQ2xCMkIsT0FBT0EsU0FBUyxFQUFFO1FBQ3BCO0lBQ0Y7QUFDRjtBQUVPLE1BQU1PLHNCQUFzQixJQUFJdEcsc0JBQXNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2hvcGlmeS1jYXJ0LXJlY292ZXJ5Ly4vc3JjL2xpYi9jYXJ0LXJlY292ZXJ5LnRzPzhiN2UiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3VwYWJhc2UgfSBmcm9tICcuL3N1cGFiYXNlJztcbmltcG9ydCB7IHZhcGlTZXJ2aWNlIH0gZnJvbSAnLi92YXBpJztcblxuZXhwb3J0IGNsYXNzIENhcnRSZWNvdmVyeVNlcnZpY2Uge1xuICBcbiAgLy8gRXh0cmFjdCBwaG9uZSBudW1iZXIgZnJvbSB2YXJpb3VzIGZpZWxkcyBpbiB0aGUgcGF5bG9hZFxuICBwcml2YXRlIGV4dHJhY3RQaG9uZU51bWJlcihwYXlsb2FkOiBhbnkpOiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBwaG9uZUZpZWxkcyA9IFtcbiAgICAgIHBheWxvYWQucGhvbmUsXG4gICAgICBwYXlsb2FkLmN1c3RvbWVyPy5waG9uZSxcbiAgICAgIHBheWxvYWQuY3VzdG9tZXI/LmRlZmF1bHRfYWRkcmVzcz8ucGhvbmUsXG4gICAgICBwYXlsb2FkLmJpbGxpbmdfYWRkcmVzcz8ucGhvbmUsXG4gICAgICBwYXlsb2FkLnNoaXBwaW5nX2FkZHJlc3M/LnBob25lLFxuICAgICAgcGF5bG9hZC5zbXNfbWFya2V0aW5nX3Bob25lXG4gICAgXTtcblxuICAgIGZvciAoY29uc3QgcGhvbmUgb2YgcGhvbmVGaWVsZHMpIHtcbiAgICAgIGlmIChwaG9uZSAmJiB0eXBlb2YgcGhvbmUgPT09ICdzdHJpbmcnICYmIHBob25lLnRyaW0oKSkge1xuICAgICAgICByZXR1cm4gcGhvbmUudHJpbSgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8vIEV4dHJhY3QgY3VzdG9tZXIgbmFtZSBmcm9tIHBheWxvYWRcbiAgcHJpdmF0ZSBleHRyYWN0Q3VzdG9tZXJOYW1lKHBheWxvYWQ6IGFueSk6IHN0cmluZyB7XG4gICAgY29uc3QgZmlyc3ROYW1lID0gcGF5bG9hZC5jdXN0b21lcj8uZmlyc3RfbmFtZSB8fCBwYXlsb2FkLmJpbGxpbmdfYWRkcmVzcz8uZmlyc3RfbmFtZSB8fCAnJztcbiAgICBjb25zdCBsYXN0TmFtZSA9IHBheWxvYWQuY3VzdG9tZXI/Lmxhc3RfbmFtZSB8fCBwYXlsb2FkLmJpbGxpbmdfYWRkcmVzcz8ubGFzdF9uYW1lIHx8ICcnO1xuICAgIGNvbnN0IGZ1bGxOYW1lID0gcGF5bG9hZC5jdXN0b21lcj8uZGVmYXVsdF9hZGRyZXNzPy5uYW1lIHx8IHBheWxvYWQuYmlsbGluZ19hZGRyZXNzPy5uYW1lIHx8ICcnO1xuICAgIFxuICAgIGlmIChmaXJzdE5hbWUgfHwgbGFzdE5hbWUpIHtcbiAgICAgIHJldHVybiBgJHtmaXJzdE5hbWV9ICR7bGFzdE5hbWV9YC50cmltKCk7XG4gICAgfVxuICAgIGlmIChmdWxsTmFtZSkge1xuICAgICAgcmV0dXJuIGZ1bGxOYW1lO1xuICAgIH1cbiAgICByZXR1cm4gJ0N1c3RvbWVyJztcbiAgfVxuXG4gIC8vIEV4dHJhY3QgbWFpbiBwcm9kdWN0IG5hbWUgZnJvbSBsaW5lIGl0ZW1zXG4gIHByaXZhdGUgZXh0cmFjdE1haW5Qcm9kdWN0TmFtZShsaW5lSXRlbXM6IGFueVtdKTogc3RyaW5nIHtcbiAgICBpZiAoIWxpbmVJdGVtcyB8fCBsaW5lSXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gJ1Byb2R1Y3QnO1xuICAgIH1cbiAgICByZXR1cm4gbGluZUl0ZW1zWzBdPy50aXRsZSB8fCBsaW5lSXRlbXNbMF0/LnByZXNlbnRtZW50X3RpdGxlIHx8ICdQcm9kdWN0JztcbiAgfVxuXG4gIC8vIFByb2Nlc3MgY2hlY2tvdXQgd2ViaG9vayBhbmQgc2F2ZSBhYmFuZG9uZWQgY2FydCBpZiBpdCBoYXMgcGhvbmUgbnVtYmVyXG4gIGFzeW5jIHByb2Nlc3NDaGVja291dFdlYmhvb2socGF5bG9hZDogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcGhvbmVOdW1iZXIgPSB0aGlzLmV4dHJhY3RQaG9uZU51bWJlcihwYXlsb2FkKTtcbiAgICBcbiAgICBpZiAoIXBob25lTnVtYmVyKSB7XG4gICAgICBjb25zb2xlLmxvZygnTm8gcGhvbmUgbnVtYmVyIGZvdW5kIGluIGNoZWNrb3V0LCBza2lwcGluZyBjYXJ0IHJlY292ZXJ5Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgYWJhbmRvbmVkQ2FydCA9IHtcbiAgICAgIGNoZWNrb3V0X2lkOiBwYXlsb2FkLmlkLFxuICAgICAgdG9rZW46IHBheWxvYWQudG9rZW4sXG4gICAgICBjdXN0b21lcl9waG9uZTogcGhvbmVOdW1iZXIsXG4gICAgICBjdXN0b21lcl9lbWFpbDogcGF5bG9hZC5lbWFpbCB8fCBwYXlsb2FkLmN1c3RvbWVyPy5lbWFpbCxcbiAgICAgIGN1c3RvbWVyX25hbWU6IHRoaXMuZXh0cmFjdEN1c3RvbWVyTmFtZShwYXlsb2FkKSxcbiAgICAgIHRvdGFsX3ByaWNlOiBwYXJzZUZsb2F0KHBheWxvYWQudG90YWxfcHJpY2UgfHwgJzAnKSxcbiAgICAgIGN1cnJlbmN5OiBwYXlsb2FkLmN1cnJlbmN5IHx8ICdVU0QnLFxuICAgICAgbGluZV9pdGVtczogcGF5bG9hZC5saW5lX2l0ZW1zIHx8IFtdLFxuICAgICAgY3JlYXRlZF9hdDogcGF5bG9hZC5jcmVhdGVkX2F0IHx8IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICB9O1xuXG4gICAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhYmFuZG9uZWRfY2FydHMnKVxuICAgICAgLnVwc2VydChhYmFuZG9uZWRDYXJ0LCB7IFxuICAgICAgICBvbkNvbmZsaWN0OiAndG9rZW4nLFxuICAgICAgICBpZ25vcmVEdXBsaWNhdGVzOiBmYWxzZSBcbiAgICAgIH0pO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgYWJhbmRvbmVkIGNhcnQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFNhdmVkIGFiYW5kb25lZCBjYXJ0IHdpdGggcGhvbmU6ICR7cGhvbmVOdW1iZXJ9YCk7XG4gIH1cblxuICAvLyBQcm9jZXNzIG9yZGVyIHdlYmhvb2sgdG8gbWFyayBjYXJ0IGFzIGNvbXBsZXRlZFxuICBhc3luYyBwcm9jZXNzT3JkZXJXZWJob29rKHBheWxvYWQ6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNoZWNrb3V0VG9rZW4gPSBwYXlsb2FkLmNoZWNrb3V0X3Rva2VuO1xuICAgIFxuICAgIGlmICghY2hlY2tvdXRUb2tlbikge1xuICAgICAgY29uc29sZS5sb2coJ05vIGNoZWNrb3V0IHRva2VuIGluIG9yZGVyLCBza2lwcGluZycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG9yZGVyRGF0YSA9IHtcbiAgICAgIG9yZGVyX2lkOiBwYXlsb2FkLmlkLFxuICAgICAgY2hlY2tvdXRfdG9rZW46IGNoZWNrb3V0VG9rZW4sXG4gICAgICBjdXN0b21lcl9lbWFpbDogcGF5bG9hZC5lbWFpbCB8fCBwYXlsb2FkLmN1c3RvbWVyPy5lbWFpbCxcbiAgICAgIGN1c3RvbWVyX3Bob25lOiBwYXlsb2FkLmN1c3RvbWVyPy5waG9uZSB8fCBwYXlsb2FkLmJpbGxpbmdfYWRkcmVzcz8ucGhvbmUsXG4gICAgICB0b3RhbF9wcmljZTogcGFyc2VGbG9hdChwYXlsb2FkLnRvdGFsX3ByaWNlIHx8ICcwJyksXG4gICAgICBjdXJyZW5jeTogcGF5bG9hZC5jdXJyZW5jeSB8fCAnVVNEJyxcbiAgICAgIGNyZWF0ZWRfYXQ6IHBheWxvYWQuY3JlYXRlZF9hdCB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBwYXlsb2FkOiBwYXlsb2FkXG4gICAgfTtcblxuICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ29yZGVycycpLnVwc2VydChvcmRlckRhdGEsIHsgb25Db25mbGljdDogJ29yZGVyX2lkJyB9KTtcblxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnYWJhbmRvbmVkX2NhcnRzJylcbiAgICAgIC51cGRhdGUoeyBcbiAgICAgICAgaXNfY29tcGxldGVkOiB0cnVlLCBcbiAgICAgICAgY29tcGxldGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgXG4gICAgICB9KVxuICAgICAgLmVxKCd0b2tlbicsIGNoZWNrb3V0VG9rZW4pO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXJraW5nIGNhcnQgYXMgY29tcGxldGVkOicsIGVycm9yKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coYE1hcmtlZCBjYXJ0ICR7Y2hlY2tvdXRUb2tlbn0gYXMgY29tcGxldGVkYCk7XG4gICAgfVxuICB9XG5cbiAgLy8gUHJvY2VzcyBhbGwgZXhpc3Rpbmcgd2ViaG9va19jYWxscyB0byBmaW5kIGFiYW5kb25lZCBjYXJ0cyB3aXRoIHBob25lIG51bWJlcnNcbiAgYXN5bmMgcHJvY2Vzc0FsbFdlYmhvb2tDYWxscygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IGRhdGE6IHdlYmhvb2tzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3dlYmhvb2tfY2FsbHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuaW4oJ3RvcGljJywgWydjaGVja291dHMvY3JlYXRlJywgJ2NoZWNrb3V0cy91cGRhdGUnXSk7XG5cbiAgICBmb3IgKGNvbnN0IHdlYmhvb2sgb2Ygd2ViaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHBheWxvYWQgPSB3ZWJob29rLnBheWxvYWQ7XG4gICAgICBjb25zdCBwaG9uZU51bWJlciA9IHRoaXMuZXh0cmFjdFBob25lTnVtYmVyKHBheWxvYWQpO1xuICAgICAgXG4gICAgICBpZiAoIXBob25lTnVtYmVyIHx8ICFwYXlsb2FkLnRva2VuKSBjb250aW51ZTtcblxuICAgICAgLy8gQ2hlY2sgaWYgY2FydCBhbHJlYWR5IGV4aXN0c1xuICAgICAgY29uc3QgeyBkYXRhOiBleGlzdGluZ0NhcnQgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdhYmFuZG9uZWRfY2FydHMnKVxuICAgICAgICAuc2VsZWN0KCdpZCcpXG4gICAgICAgIC5lcSgndG9rZW4nLCBwYXlsb2FkLnRva2VuKVxuICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgIGlmIChleGlzdGluZ0NhcnQpIGNvbnRpbnVlO1xuXG4gICAgICAvLyBDcmVhdGUgY2FydCByZWNvcmRcbiAgICAgIGNvbnN0IGNhcnREYXRhID0ge1xuICAgICAgICBjaGVja291dF9pZDogcGF5bG9hZC5pZCxcbiAgICAgICAgdG9rZW46IHBheWxvYWQudG9rZW4sXG4gICAgICAgIGN1c3RvbWVyX3Bob25lOiBwaG9uZU51bWJlcixcbiAgICAgICAgY3VzdG9tZXJfZW1haWw6IHBheWxvYWQuZW1haWwgfHwgcGF5bG9hZC5jdXN0b21lcj8uZW1haWwsXG4gICAgICAgIGN1c3RvbWVyX25hbWU6IHRoaXMuZXh0cmFjdEN1c3RvbWVyTmFtZShwYXlsb2FkKSxcbiAgICAgICAgdG90YWxfcHJpY2U6IHBhcnNlRmxvYXQocGF5bG9hZC50b3RhbF9wcmljZSB8fCAnMCcpLFxuICAgICAgICBjdXJyZW5jeTogcGF5bG9hZC5jdXJyZW5jeSB8fCAnVVNEJyxcbiAgICAgICAgbGluZV9pdGVtczogcGF5bG9hZC5saW5lX2l0ZW1zIHx8IFtdLFxuICAgICAgICBjcmVhdGVkX2F0OiBwYXlsb2FkLmNyZWF0ZWRfYXQgfHwgd2ViaG9vay5jcmVhdGVkX2F0LFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgc3VwYWJhc2UuZnJvbSgnYWJhbmRvbmVkX2NhcnRzJykuaW5zZXJ0KGNhcnREYXRhKTtcbiAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzZWQgZXhpc3Rpbmcgd2ViaG9vayBmb3IgY2FydCAke3BheWxvYWQudG9rZW59YCk7XG4gICAgfVxuICB9XG4gIGFzeW5jIHByb2Nlc3NTY2hlZHVsZWRDYWxscygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgIFxuICAgIC8vIEdldCBhbGwgaW5jb21wbGV0ZSBjYXJ0cyB3aXRoIHBob25lIG51bWJlcnNcbiAgICBjb25zdCB7IGRhdGE6IGNhcnRzLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhYmFuZG9uZWRfY2FydHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lzX2NvbXBsZXRlZCcsIGZhbHNlKVxuICAgICAgLm5vdCgnY3VzdG9tZXJfcGhvbmUnLCAnaXMnLCBudWxsKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgYWJhbmRvbmVkIGNhcnRzOicsIGVycm9yKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgRm91bmQgJHtjYXJ0cz8ubGVuZ3RoIHx8IDB9IGFiYW5kb25lZCBjYXJ0cyB0byBwcm9jZXNzYCk7XG5cbiAgICBmb3IgKGNvbnN0IGNhcnQgb2YgY2FydHMgfHwgW10pIHtcbiAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIGNhcnQgJHtjYXJ0LnRva2VufWApO1xuICAgICAgXG4gICAgICAvLyBHZXQgZXhpc3RpbmcgY2FsbCBsb2cgZm9yIHRoaXMgY2FydFxuICAgICAgbGV0IHsgZGF0YTogY2FsbExvZyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NhbGxfbG9ncycpXG4gICAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgICAuZXEoJ2FiYW5kb25lZF9jYXJ0X2lkJywgY2FydC5pZClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBpZiAoIWNhbGxMb2cpIHtcbiAgICAgICAgY29uc29sZS5sb2coYENyZWF0aW5nIGNhbGwgbG9nIGZvciBjYXJ0ICR7Y2FydC50b2tlbn1gKTtcbiAgICAgICAgY29uc3QgeyBkYXRhOiBuZXdDYWxsTG9nIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgIC5mcm9tKCdjYWxsX2xvZ3MnKVxuICAgICAgICAgIC5pbnNlcnQoe1xuICAgICAgICAgICAgYWJhbmRvbmVkX2NhcnRfaWQ6IGNhcnQuaWQsXG4gICAgICAgICAgICBwaG9uZV9udW1iZXI6IGNhcnQuY3VzdG9tZXJfcGhvbmVcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAgIC5zaW5nbGUoKTtcbiAgICAgICAgY2FsbExvZyA9IG5ld0NhbGxMb2c7XG4gICAgICB9XG5cbiAgICAgIGlmICghY2FsbExvZykgY29udGludWU7XG5cbiAgICAgIC8vIE1ha2UgZmlyc3QgYXZhaWxhYmxlIGNhbGxcbiAgICAgIGxldCBjYWxsVG9NYWtlID0gbnVsbDtcbiAgICAgIGxldCBob3VyRmllbGQgPSBudWxsO1xuICAgICAgXG4gICAgICBpZiAoY2FsbExvZy5jYWxsXzJfaG91ciA9PT0gMCkge1xuICAgICAgICBjYWxsVG9NYWtlID0gJzJfaG91cic7XG4gICAgICAgIGhvdXJGaWVsZCA9ICdjYWxsXzJfaG91cic7XG4gICAgICB9IGVsc2UgaWYgKGNhbGxMb2cuY2FsbF80X2hvdXIgPT09IDApIHtcbiAgICAgICAgY2FsbFRvTWFrZSA9ICc0X2hvdXInO1xuICAgICAgICBob3VyRmllbGQgPSAnY2FsbF80X2hvdXInO1xuICAgICAgfSBlbHNlIGlmIChjYWxsTG9nLmNhbGxfOF9ob3VyID09PSAwKSB7XG4gICAgICAgIGNhbGxUb01ha2UgPSAnOF9ob3VyJztcbiAgICAgICAgaG91ckZpZWxkID0gJ2NhbGxfOF9ob3VyJztcbiAgICAgIH0gZWxzZSBpZiAoY2FsbExvZy5jYWxsXzE2X2hvdXIgPT09IDApIHtcbiAgICAgICAgY2FsbFRvTWFrZSA9ICcxNl9ob3VyJztcbiAgICAgICAgaG91ckZpZWxkID0gJ2NhbGxfMTZfaG91cic7XG4gICAgICB9IGVsc2UgaWYgKGNhbGxMb2cuY2FsbF8yNF9ob3VyID09PSAwKSB7XG4gICAgICAgIGNhbGxUb01ha2UgPSAnMjRfaG91cic7XG4gICAgICAgIGhvdXJGaWVsZCA9ICdjYWxsXzI0X2hvdXInO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2FsbFRvTWFrZSAmJiBob3VyRmllbGQpIHtcbiAgICAgICAgY29uc29sZS5sb2coYE1ha2luZyAke2NhbGxUb01ha2V9IGNhbGwgZm9yIGNhcnQgJHtjYXJ0LnRva2VufWApO1xuICAgICAgICBhd2FpdCB0aGlzLm1ha2VSZWNvdmVyeUNhbGwoY2FydCwgY2FsbExvZywgY2FsbFRvTWFrZSwgaG91ckZpZWxkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBObyBjYWxscyBuZWVkZWQgZm9yIGNhcnQgJHtjYXJ0LnRva2VufWApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIE1ha2UgYSByZWNvdmVyeSBjYWxsIGZvciBhIHNwZWNpZmljIGNhcnRcbiAgcHJpdmF0ZSBhc3luYyBtYWtlUmVjb3ZlcnlDYWxsKGNhcnQ6IGFueSwgY2FsbExvZzogYW55LCBjYWxsVHlwZTogc3RyaW5nLCBob3VyRmllbGQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghY2FydC5jdXN0b21lcl9waG9uZSkgcmV0dXJuO1xuXG4gICAgY29uc3QgcHJvZHVjdE5hbWUgPSB0aGlzLmV4dHJhY3RNYWluUHJvZHVjdE5hbWUoY2FydC5saW5lX2l0ZW1zKTtcbiAgICBcbiAgICBjb25zb2xlLmxvZyhgTWFraW5nICR7Y2FsbFR5cGV9IGNhbGwgdG8gJHtjYXJ0LmN1c3RvbWVyX3Bob25lfSBmb3IgY2FydCAke2NhcnQudG9rZW59YCk7XG5cbiAgICBjb25zdCBjYWxsUmVzdWx0ID0gYXdhaXQgdmFwaVNlcnZpY2UubWFrZUNhbGwoXG4gICAgICBjYXJ0LmN1c3RvbWVyX3Bob25lLFxuICAgICAgY2FydC5jdXN0b21lcl9uYW1lIHx8ICdDdXN0b21lcicsXG4gICAgICBwcm9kdWN0TmFtZVxuICAgICk7XG5cbiAgICAvLyBVcGRhdGUgY2FsbCBsb2cgd2l0aCB0aGUgcmVzdWx0XG4gICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdjYWxsX2xvZ3MnKVxuICAgICAgLnVwZGF0ZSh7XG4gICAgICAgIFtob3VyRmllbGRdOiAxLFxuICAgICAgICB2YXBpX3Jlc3BvbnNlOiBjYWxsUmVzdWx0LFxuICAgICAgICBzdWNjZXNzOiBjYWxsUmVzdWx0LnN1Y2Nlc3NcbiAgICAgIH0pXG4gICAgICAuZXEoJ2lkJywgY2FsbExvZy5pZCk7XG5cbiAgICAvLyBBbHNvIHVwZGF0ZSBhYmFuZG9uZWRfY2FydHMgdGFibGVcbiAgICBjb25zdCB1cGRhdGVUaW1lRmllbGQgPSBgY2FsbF8ke2NhbGxUeXBlfV9hdGA7XG4gICAgXG4gICAgYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhYmFuZG9uZWRfY2FydHMnKVxuICAgICAgLnVwZGF0ZSh7XG4gICAgICAgIFtgY2FsbF8ke2NhbGxUeXBlLnJlcGxhY2UoJ19ob3VyJywgJ19ob3VyJyl9YF06IHRydWUsXG4gICAgICAgIFt1cGRhdGVUaW1lRmllbGRdOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICAgIH0pXG4gICAgICAuZXEoJ2lkJywgY2FydC5pZCk7XG5cbiAgICBjb25zb2xlLmxvZyhgJHtjYWxsVHlwZX0gY2FsbCAke2NhbGxSZXN1bHQuc3VjY2VzcyA/ICdzdWNjZXNzZnVsJyA6ICdmYWlsZWQnfSBmb3IgY2FydCAke2NhcnQudG9rZW59YCk7XG4gIH1cblxuICAvLyBHZXQgZGFpbHkgc3RhdHNcbiAgYXN5bmMgZ2V0RGFpbHlTdGF0cyhkYXRlPzogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCB7IGRhdGE6IGNhcnRzIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FiYW5kb25lZF9jYXJ0cycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5vcmRlcignY3JlYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIGNvbnN0IHsgZGF0YTogY2FsbHMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnY2FsbF9sb2dzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsQWJhbmRvbmVkOiBjYXJ0cz8ubGVuZ3RoIHx8IDAsXG4gICAgICB0b3RhbENvbXBsZXRlZDogY2FydHM/LmZpbHRlcihjID0+IGMuaXNfY29tcGxldGVkKS5sZW5ndGggfHwgMCxcbiAgICAgIHRvdGFsQ2FsbHM6IGNhbGxzPy5sZW5ndGggfHwgMCxcbiAgICAgIHN1Y2Nlc3NmdWxDYWxsczogY2FsbHM/LmZpbHRlcihjID0+IGMuc3VjY2VzcykubGVuZ3RoIHx8IDAsXG4gICAgICBjYXJ0czogY2FydHMgfHwgW10sXG4gICAgICBjYWxsczogY2FsbHMgfHwgW11cbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBjYXJ0UmVjb3ZlcnlTZXJ2aWNlID0gbmV3IENhcnRSZWNvdmVyeVNlcnZpY2UoKTsiXSwibmFtZXMiOlsic3VwYWJhc2UiLCJ2YXBpU2VydmljZSIsIkNhcnRSZWNvdmVyeVNlcnZpY2UiLCJleHRyYWN0UGhvbmVOdW1iZXIiLCJwYXlsb2FkIiwicGhvbmVGaWVsZHMiLCJwaG9uZSIsImN1c3RvbWVyIiwiZGVmYXVsdF9hZGRyZXNzIiwiYmlsbGluZ19hZGRyZXNzIiwic2hpcHBpbmdfYWRkcmVzcyIsInNtc19tYXJrZXRpbmdfcGhvbmUiLCJ0cmltIiwiZXh0cmFjdEN1c3RvbWVyTmFtZSIsImZpcnN0TmFtZSIsImZpcnN0X25hbWUiLCJsYXN0TmFtZSIsImxhc3RfbmFtZSIsImZ1bGxOYW1lIiwibmFtZSIsImV4dHJhY3RNYWluUHJvZHVjdE5hbWUiLCJsaW5lSXRlbXMiLCJsZW5ndGgiLCJ0aXRsZSIsInByZXNlbnRtZW50X3RpdGxlIiwicHJvY2Vzc0NoZWNrb3V0V2ViaG9vayIsInBob25lTnVtYmVyIiwiY29uc29sZSIsImxvZyIsImFiYW5kb25lZENhcnQiLCJjaGVja291dF9pZCIsImlkIiwidG9rZW4iLCJjdXN0b21lcl9waG9uZSIsImN1c3RvbWVyX2VtYWlsIiwiZW1haWwiLCJjdXN0b21lcl9uYW1lIiwidG90YWxfcHJpY2UiLCJwYXJzZUZsb2F0IiwiY3VycmVuY3kiLCJsaW5lX2l0ZW1zIiwiY3JlYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImVycm9yIiwiZnJvbSIsInVwc2VydCIsIm9uQ29uZmxpY3QiLCJpZ25vcmVEdXBsaWNhdGVzIiwicHJvY2Vzc09yZGVyV2ViaG9vayIsImNoZWNrb3V0VG9rZW4iLCJjaGVja291dF90b2tlbiIsIm9yZGVyRGF0YSIsIm9yZGVyX2lkIiwidXBkYXRlIiwiaXNfY29tcGxldGVkIiwiY29tcGxldGVkX2F0IiwiZXEiLCJwcm9jZXNzQWxsV2ViaG9va0NhbGxzIiwiZGF0YSIsIndlYmhvb2tzIiwic2VsZWN0IiwiaW4iLCJ3ZWJob29rIiwiZXhpc3RpbmdDYXJ0Iiwic2luZ2xlIiwiY2FydERhdGEiLCJpbnNlcnQiLCJwcm9jZXNzU2NoZWR1bGVkQ2FsbHMiLCJub3ciLCJjYXJ0cyIsIm5vdCIsImNhcnQiLCJjYWxsTG9nIiwibmV3Q2FsbExvZyIsImFiYW5kb25lZF9jYXJ0X2lkIiwicGhvbmVfbnVtYmVyIiwiY2FsbFRvTWFrZSIsImhvdXJGaWVsZCIsImNhbGxfMl9ob3VyIiwiY2FsbF80X2hvdXIiLCJjYWxsXzhfaG91ciIsImNhbGxfMTZfaG91ciIsImNhbGxfMjRfaG91ciIsIm1ha2VSZWNvdmVyeUNhbGwiLCJjYWxsVHlwZSIsInByb2R1Y3ROYW1lIiwiY2FsbFJlc3VsdCIsIm1ha2VDYWxsIiwidmFwaV9yZXNwb25zZSIsInN1Y2Nlc3MiLCJ1cGRhdGVUaW1lRmllbGQiLCJyZXBsYWNlIiwiZ2V0RGFpbHlTdGF0cyIsImRhdGUiLCJvcmRlciIsImFzY2VuZGluZyIsImNhbGxzIiwidG90YWxBYmFuZG9uZWQiLCJ0b3RhbENvbXBsZXRlZCIsImZpbHRlciIsImMiLCJ0b3RhbENhbGxzIiwic3VjY2Vzc2Z1bENhbGxzIiwiY2FydFJlY292ZXJ5U2VydmljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/cart-recovery.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/shopify.ts":
/*!****************************!*\
  !*** ./src/lib/shopify.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   processCartWebhook: () => (/* binding */ processCartWebhook)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/.pnpm/axios@1.13.2/node_modules/axios/lib/axios.js\");\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(rsc)/./src/lib/supabase.ts\");\n\n\nasync function processCartWebhook(cartData) {\n    console.log(\"Processing cart webhook:\", cartData.id);\n    // Save cart to Supabase\n    await (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.saveCart)(cartData);\n    // Check if cart has items but no checkout started\n    if (cartData.line_items.length > 0 && !cartData.abandoned_checkout_url) {\n        setTimeout(()=>{\n            checkCartAbandonment(cartData);\n        }, 30 * 60 * 1000) // Check after 30 minutes\n        ;\n    }\n}\nasync function checkCartAbandonment(cart) {\n    // Mark cart as abandoned in database\n    await (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.markCartAbandoned)(cart.id);\n    // Generate persistent cart link\n    const cartLink = await generateCartLink(cart.token);\n    if (cartLink && (cart.phone || cart.email)) {\n        await sendVapiCall(cart, cartLink);\n    }\n}\nasync function generateCartLink(cartToken) {\n    try {\n        const shopDomain = process.env.SHOPIFY_SHOP_DOMAIN;\n        return `https://${shopDomain}/cart/${cartToken}`;\n    } catch (error) {\n        console.error(\"Error generating cart link:\", error);\n        return null;\n    }\n}\nasync function sendVapiCall(cart, cartLink) {\n    try {\n        const vapiResponse = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].post(\"https://api.vapi.ai/call\", {\n            phoneNumberId: process.env.VAPI_PHONE_NUMBER_ID,\n            customer: {\n                number: cart.phone\n            },\n            assistant: {\n                model: {\n                    provider: \"openai\",\n                    model: \"gpt-3.5-turbo\"\n                },\n                voice: {\n                    provider: \"11labs\",\n                    voiceId: \"21m00Tcm4TlvDq8ikWAM\"\n                },\n                firstMessage: `Hi! You left some items in your cart. Complete your purchase here: ${cartLink}`\n            }\n        }, {\n            headers: {\n                \"Authorization\": `Bearer ${process.env.VAPI_API_KEY}`,\n                \"Content-Type\": \"application/json\"\n            }\n        });\n        // Mark call as sent in database\n        await (0,_supabase__WEBPACK_IMPORTED_MODULE_0__.markCallSent)(cart.id);\n        console.log(\"Vapi call initiated:\", vapiResponse.data);\n    } catch (error) {\n        console.error(\"Error sending Vapi call:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3Nob3BpZnkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXlCO0FBQzZDO0FBb0IvRCxlQUFlSSxtQkFBbUJDLFFBQWM7SUFDckRDLFFBQVFDLEdBQUcsQ0FBQyw0QkFBNEJGLFNBQVNHLEVBQUU7SUFFbkQsd0JBQXdCO0lBQ3hCLE1BQU1QLG1EQUFRQSxDQUFDSTtJQUVmLGtEQUFrRDtJQUNsRCxJQUFJQSxTQUFTSSxVQUFVLENBQUNDLE1BQU0sR0FBRyxLQUFLLENBQUNMLFNBQVNNLHNCQUFzQixFQUFFO1FBQ3RFQyxXQUFXO1lBQ1RDLHFCQUFxQlI7UUFDdkIsR0FBRyxLQUFLLEtBQUssTUFBTSx5QkFBeUI7O0lBQzlDO0FBQ0Y7QUFFQSxlQUFlUSxxQkFBcUJDLElBQVU7SUFDNUMscUNBQXFDO0lBQ3JDLE1BQU1aLDREQUFpQkEsQ0FBQ1ksS0FBS04sRUFBRTtJQUUvQixnQ0FBZ0M7SUFDaEMsTUFBTU8sV0FBVyxNQUFNQyxpQkFBaUJGLEtBQUtHLEtBQUs7SUFFbEQsSUFBSUYsWUFBYUQsQ0FBQUEsS0FBS0ksS0FBSyxJQUFJSixLQUFLSyxLQUFLLEdBQUc7UUFDMUMsTUFBTUMsYUFBYU4sTUFBTUM7SUFDM0I7QUFDRjtBQUVBLGVBQWVDLGlCQUFpQkssU0FBaUI7SUFDL0MsSUFBSTtRQUNGLE1BQU1DLGFBQWFDLFFBQVFDLEdBQUcsQ0FBQ0MsbUJBQW1CO1FBQ2xELE9BQU8sQ0FBQyxRQUFRLEVBQUVILFdBQVcsTUFBTSxFQUFFRCxVQUFVLENBQUM7SUFDbEQsRUFBRSxPQUFPSyxPQUFPO1FBQ2RwQixRQUFRb0IsS0FBSyxDQUFDLCtCQUErQkE7UUFDN0MsT0FBTztJQUNUO0FBQ0Y7QUFFQSxlQUFlTixhQUFhTixJQUFVLEVBQUVDLFFBQWdCO0lBQ3RELElBQUk7UUFDRixNQUFNWSxlQUFlLE1BQU0zQiw2Q0FBS0EsQ0FBQzRCLElBQUksQ0FBQyw0QkFBNEI7WUFDaEVDLGVBQWVOLFFBQVFDLEdBQUcsQ0FBQ00sb0JBQW9CO1lBQy9DQyxVQUFVO2dCQUNSQyxRQUFRbEIsS0FBS0ksS0FBSztZQUNwQjtZQUNBZSxXQUFXO2dCQUNUQyxPQUFPO29CQUNMQyxVQUFVO29CQUNWRCxPQUFPO2dCQUNUO2dCQUNBRSxPQUFPO29CQUNMRCxVQUFVO29CQUNWRSxTQUFTO2dCQUNYO2dCQUNBQyxjQUFjLENBQUMsbUVBQW1FLEVBQUV2QixTQUFTLENBQUM7WUFDaEc7UUFDRixHQUFHO1lBQ0R3QixTQUFTO2dCQUNQLGlCQUFpQixDQUFDLE9BQU8sRUFBRWhCLFFBQVFDLEdBQUcsQ0FBQ2dCLFlBQVksQ0FBQyxDQUFDO2dCQUNyRCxnQkFBZ0I7WUFDbEI7UUFDRjtRQUVBLGdDQUFnQztRQUNoQyxNQUFNckMsdURBQVlBLENBQUNXLEtBQUtOLEVBQUU7UUFFMUJGLFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0JvQixhQUFhYyxJQUFJO0lBQ3ZELEVBQUUsT0FBT2YsT0FBTztRQUNkcEIsUUFBUW9CLEtBQUssQ0FBQyw0QkFBNEJBO0lBQzVDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaG9waWZ5LWNhcnQtcmVjb3ZlcnkvLi9zcmMvbGliL3Nob3BpZnkudHM/ODNjOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnXG5pbXBvcnQgeyBzYXZlQ2FydCwgbWFya0NhcnRBYmFuZG9uZWQsIG1hcmtDYWxsU2VudCB9IGZyb20gJy4vc3VwYWJhc2UnXG5cbmludGVyZmFjZSBDYXJ0SXRlbSB7XG4gIGlkOiBzdHJpbmdcbiAgcXVhbnRpdHk6IG51bWJlclxuICB2YXJpYW50X2lkOiBzdHJpbmdcbiAgcHJvZHVjdF9pZDogc3RyaW5nXG59XG5cbmludGVyZmFjZSBDYXJ0IHtcbiAgaWQ6IHN0cmluZ1xuICB0b2tlbjogc3RyaW5nXG4gIGxpbmVfaXRlbXM6IENhcnRJdGVtW11cbiAgY3JlYXRlZF9hdDogc3RyaW5nXG4gIHVwZGF0ZWRfYXQ6IHN0cmluZ1xuICBhYmFuZG9uZWRfY2hlY2tvdXRfdXJsPzogc3RyaW5nXG4gIHBob25lPzogc3RyaW5nXG4gIGVtYWlsPzogc3RyaW5nXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwcm9jZXNzQ2FydFdlYmhvb2soY2FydERhdGE6IENhcnQpIHtcbiAgY29uc29sZS5sb2coJ1Byb2Nlc3NpbmcgY2FydCB3ZWJob29rOicsIGNhcnREYXRhLmlkKVxuICBcbiAgLy8gU2F2ZSBjYXJ0IHRvIFN1cGFiYXNlXG4gIGF3YWl0IHNhdmVDYXJ0KGNhcnREYXRhKVxuXG4gIC8vIENoZWNrIGlmIGNhcnQgaGFzIGl0ZW1zIGJ1dCBubyBjaGVja291dCBzdGFydGVkXG4gIGlmIChjYXJ0RGF0YS5saW5lX2l0ZW1zLmxlbmd0aCA+IDAgJiYgIWNhcnREYXRhLmFiYW5kb25lZF9jaGVja291dF91cmwpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNoZWNrQ2FydEFiYW5kb25tZW50KGNhcnREYXRhKVxuICAgIH0sIDMwICogNjAgKiAxMDAwKSAvLyBDaGVjayBhZnRlciAzMCBtaW51dGVzXG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gY2hlY2tDYXJ0QWJhbmRvbm1lbnQoY2FydDogQ2FydCkge1xuICAvLyBNYXJrIGNhcnQgYXMgYWJhbmRvbmVkIGluIGRhdGFiYXNlXG4gIGF3YWl0IG1hcmtDYXJ0QWJhbmRvbmVkKGNhcnQuaWQpXG4gIFxuICAvLyBHZW5lcmF0ZSBwZXJzaXN0ZW50IGNhcnQgbGlua1xuICBjb25zdCBjYXJ0TGluayA9IGF3YWl0IGdlbmVyYXRlQ2FydExpbmsoY2FydC50b2tlbilcbiAgXG4gIGlmIChjYXJ0TGluayAmJiAoY2FydC5waG9uZSB8fCBjYXJ0LmVtYWlsKSkge1xuICAgIGF3YWl0IHNlbmRWYXBpQ2FsbChjYXJ0LCBjYXJ0TGluaylcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUNhcnRMaW5rKGNhcnRUb2tlbjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2hvcERvbWFpbiA9IHByb2Nlc3MuZW52LlNIT1BJRllfU0hPUF9ET01BSU5cbiAgICByZXR1cm4gYGh0dHBzOi8vJHtzaG9wRG9tYWlufS9jYXJ0LyR7Y2FydFRva2VufWBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIGNhcnQgbGluazonLCBlcnJvcilcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNlbmRWYXBpQ2FsbChjYXJ0OiBDYXJ0LCBjYXJ0TGluazogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdmFwaVJlc3BvbnNlID0gYXdhaXQgYXhpb3MucG9zdCgnaHR0cHM6Ly9hcGkudmFwaS5haS9jYWxsJywge1xuICAgICAgcGhvbmVOdW1iZXJJZDogcHJvY2Vzcy5lbnYuVkFQSV9QSE9ORV9OVU1CRVJfSUQsXG4gICAgICBjdXN0b21lcjoge1xuICAgICAgICBudW1iZXI6IGNhcnQucGhvbmVcbiAgICAgIH0sXG4gICAgICBhc3Npc3RhbnQ6IHtcbiAgICAgICAgbW9kZWw6IHtcbiAgICAgICAgICBwcm92aWRlcjogXCJvcGVuYWlcIixcbiAgICAgICAgICBtb2RlbDogXCJncHQtMy41LXR1cmJvXCJcbiAgICAgICAgfSxcbiAgICAgICAgdm9pY2U6IHtcbiAgICAgICAgICBwcm92aWRlcjogXCIxMWxhYnNcIixcbiAgICAgICAgICB2b2ljZUlkOiBcIjIxbTAwVGNtNFRsdkRxOGlrV0FNXCJcbiAgICAgICAgfSxcbiAgICAgICAgZmlyc3RNZXNzYWdlOiBgSGkhIFlvdSBsZWZ0IHNvbWUgaXRlbXMgaW4geW91ciBjYXJ0LiBDb21wbGV0ZSB5b3VyIHB1cmNoYXNlIGhlcmU6ICR7Y2FydExpbmt9YFxuICAgICAgfVxuICAgIH0sIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7cHJvY2Vzcy5lbnYuVkFQSV9BUElfS0VZfWAsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gTWFyayBjYWxsIGFzIHNlbnQgaW4gZGF0YWJhc2VcbiAgICBhd2FpdCBtYXJrQ2FsbFNlbnQoY2FydC5pZClcblxuICAgIGNvbnNvbGUubG9nKCdWYXBpIGNhbGwgaW5pdGlhdGVkOicsIHZhcGlSZXNwb25zZS5kYXRhKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgVmFwaSBjYWxsOicsIGVycm9yKVxuICB9XG59Il0sIm5hbWVzIjpbImF4aW9zIiwic2F2ZUNhcnQiLCJtYXJrQ2FydEFiYW5kb25lZCIsIm1hcmtDYWxsU2VudCIsInByb2Nlc3NDYXJ0V2ViaG9vayIsImNhcnREYXRhIiwiY29uc29sZSIsImxvZyIsImlkIiwibGluZV9pdGVtcyIsImxlbmd0aCIsImFiYW5kb25lZF9jaGVja291dF91cmwiLCJzZXRUaW1lb3V0IiwiY2hlY2tDYXJ0QWJhbmRvbm1lbnQiLCJjYXJ0IiwiY2FydExpbmsiLCJnZW5lcmF0ZUNhcnRMaW5rIiwidG9rZW4iLCJwaG9uZSIsImVtYWlsIiwic2VuZFZhcGlDYWxsIiwiY2FydFRva2VuIiwic2hvcERvbWFpbiIsInByb2Nlc3MiLCJlbnYiLCJTSE9QSUZZX1NIT1BfRE9NQUlOIiwiZXJyb3IiLCJ2YXBpUmVzcG9uc2UiLCJwb3N0IiwicGhvbmVOdW1iZXJJZCIsIlZBUElfUEhPTkVfTlVNQkVSX0lEIiwiY3VzdG9tZXIiLCJudW1iZXIiLCJhc3Npc3RhbnQiLCJtb2RlbCIsInByb3ZpZGVyIiwidm9pY2UiLCJ2b2ljZUlkIiwiZmlyc3RNZXNzYWdlIiwiaGVhZGVycyIsIlZBUElfQVBJX0tFWSIsImRhdGEiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/shopify.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getStats: () => (/* binding */ getStats),\n/* harmony export */   markCallSent: () => (/* binding */ markCallSent),\n/* harmony export */   markCartAbandoned: () => (/* binding */ markCartAbandoned),\n/* harmony export */   saveCart: () => (/* binding */ saveCart),\n/* harmony export */   saveWebhookCall: () => (/* binding */ saveWebhookCall),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/.pnpm/@supabase+supabase-js@2.87.1/node_modules/@supabase/supabase-js/dist/esm/wrapper.mjs\");\n\nconst supabaseUrl = \"https://nitpdzxgzgsdiitbfzzn.supabase.co\" || 0;\nconst supabaseKey = \"sb_publishable_3galOu-ZhNgYafXbRfogAw_NrT2Kfui\" || 0;\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseKey, {\n    auth: {\n        persistSession: false\n    },\n    db: {\n        schema: \"public\"\n    },\n    global: {\n        headers: {\n            \"x-my-custom-header\": \"my-app-name\"\n        }\n    }\n});\nasync function saveCart(cartData) {\n    const { data, error } = await supabase.from(\"carts\").upsert({\n        cart_id: cartData.id,\n        user_phone: cartData.phone,\n        user_email: cartData.email,\n        cart_token: cartData.token,\n        line_items: cartData.line_items,\n        status: \"active\",\n        call_sent: false,\n        updated_at: new Date().toISOString()\n    }).select();\n    if (error) throw error;\n    return data;\n}\nasync function markCartAbandoned(cartId) {\n    const { error } = await supabase.from(\"carts\").update({\n        status: \"abandoned\"\n    }).eq(\"cart_id\", cartId);\n    if (error) throw error;\n}\nasync function markCallSent(cartId) {\n    const { error } = await supabase.from(\"carts\").update({\n        call_sent: true\n    }).eq(\"cart_id\", cartId);\n    if (error) throw error;\n}\nasync function saveWebhookCall(topic, payload, headers) {\n    const { data, error } = await supabase.from(\"webhook_calls\").insert({\n        topic,\n        payload,\n        headers,\n        created_at: new Date().toISOString()\n    }).select();\n    if (error) throw error;\n    return data;\n}\nasync function getStats() {\n    // Return mock data if Supabase not configured\n    if (false) {}\n    const { data, error } = await supabase.from(\"carts\").select(\"status, call_sent\");\n    if (error) throw error;\n    const totalCarts = data.length;\n    const abandonedCarts = data.filter((cart)=>cart.status === \"abandoned\").length;\n    const callsSent = data.filter((cart)=>cart.call_sent).length;\n    const recoveryRate = abandonedCarts > 0 ? Math.round(callsSent / abandonedCarts * 100) : 0;\n    return {\n        totalCarts,\n        abandonedCarts,\n        callsSent,\n        recoveryRate\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBb0Q7QUFFcEQsTUFBTUMsY0FBY0MsMENBQW9DLElBQUk7QUFDNUQsTUFBTUcsY0FBY0gsZ0RBQXlDLElBQUk7QUFFMUQsTUFBTUssV0FBV1AsbUVBQVlBLENBQUNDLGFBQWFJLGFBQWE7SUFDN0RHLE1BQU07UUFDSkMsZ0JBQWdCO0lBQ2xCO0lBQ0FDLElBQUk7UUFDRkMsUUFBUTtJQUNWO0lBQ0FDLFFBQVE7UUFDTkMsU0FBUztZQUFFLHNCQUFzQjtRQUFjO0lBQ2pEO0FBQ0YsR0FBRTtBQWVLLGVBQWVDLFNBQVNDLFFBQWE7SUFDMUMsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1WLFNBQzNCVyxJQUFJLENBQUMsU0FDTEMsTUFBTSxDQUFDO1FBQ05DLFNBQVNMLFNBQVNNLEVBQUU7UUFDcEJDLFlBQVlQLFNBQVNRLEtBQUs7UUFDMUJDLFlBQVlULFNBQVNVLEtBQUs7UUFDMUJDLFlBQVlYLFNBQVNZLEtBQUs7UUFDMUJDLFlBQVliLFNBQVNhLFVBQVU7UUFDL0JDLFFBQVE7UUFDUkMsV0FBVztRQUNYQyxZQUFZLElBQUlDLE9BQU9DLFdBQVc7SUFDcEMsR0FDQ0MsTUFBTTtJQUVULElBQUlqQixPQUFPLE1BQU1BO0lBQ2pCLE9BQU9EO0FBQ1Q7QUFFTyxlQUFlbUIsa0JBQWtCQyxNQUFjO0lBQ3BELE1BQU0sRUFBRW5CLEtBQUssRUFBRSxHQUFHLE1BQU1WLFNBQ3JCVyxJQUFJLENBQUMsU0FDTG1CLE1BQU0sQ0FBQztRQUFFUixRQUFRO0lBQVksR0FDN0JTLEVBQUUsQ0FBQyxXQUFXRjtJQUVqQixJQUFJbkIsT0FBTyxNQUFNQTtBQUNuQjtBQUVPLGVBQWVzQixhQUFhSCxNQUFjO0lBQy9DLE1BQU0sRUFBRW5CLEtBQUssRUFBRSxHQUFHLE1BQU1WLFNBQ3JCVyxJQUFJLENBQUMsU0FDTG1CLE1BQU0sQ0FBQztRQUFFUCxXQUFXO0lBQUssR0FDekJRLEVBQUUsQ0FBQyxXQUFXRjtJQUVqQixJQUFJbkIsT0FBTyxNQUFNQTtBQUNuQjtBQUVPLGVBQWV1QixnQkFBZ0JDLEtBQWEsRUFBRUMsT0FBWSxFQUFFN0IsT0FBWTtJQUM3RSxNQUFNLEVBQUVHLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTVYsU0FDM0JXLElBQUksQ0FBQyxpQkFDTHlCLE1BQU0sQ0FBQztRQUNORjtRQUNBQztRQUNBN0I7UUFDQStCLFlBQVksSUFBSVosT0FBT0MsV0FBVztJQUNwQyxHQUNDQyxNQUFNO0lBRVQsSUFBSWpCLE9BQU8sTUFBTUE7SUFDakIsT0FBT0Q7QUFDVDtBQUVPLGVBQWU2QjtJQUNwQiw4Q0FBOEM7SUFDOUMsSUFBSSxLQUFtRixFQUFFLEVBRXhGO0lBRUQsTUFBTSxFQUFFN0IsSUFBSSxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNVixTQUMzQlcsSUFBSSxDQUFDLFNBQ0xnQixNQUFNLENBQUM7SUFFVixJQUFJakIsT0FBTyxNQUFNQTtJQUVqQixNQUFNNkIsYUFBYTlCLEtBQUtrQyxNQUFNO0lBQzlCLE1BQU1ILGlCQUFpQi9CLEtBQUttQyxNQUFNLENBQUMsQ0FBQ0MsT0FBY0EsS0FBS3ZCLE1BQU0sS0FBSyxhQUFhcUIsTUFBTTtJQUNyRixNQUFNRixZQUFZaEMsS0FBS21DLE1BQU0sQ0FBQyxDQUFDQyxPQUFjQSxLQUFLdEIsU0FBUyxFQUFFb0IsTUFBTTtJQUNuRSxNQUFNRCxlQUFlRixpQkFBaUIsSUFBSU0sS0FBS0MsS0FBSyxDQUFDLFlBQWFQLGlCQUFrQixPQUFPO0lBRTNGLE9BQU87UUFBRUQ7UUFBWUM7UUFBZ0JDO1FBQVdDO0lBQWE7QUFDL0QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zaG9waWZ5LWNhcnQtcmVjb3ZlcnkvLi9zcmMvbGliL3N1cGFiYXNlLnRzPzA2ZTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJ1xuXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCAnaHR0cHM6Ly9wbGFjZWhvbGRlci5zdXBhYmFzZS5jbydcbmNvbnN0IHN1cGFiYXNlS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkgfHwgJ3BsYWNlaG9sZGVyLWtleSdcblxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUtleSwge1xuICBhdXRoOiB7XG4gICAgcGVyc2lzdFNlc3Npb246IGZhbHNlXG4gIH0sXG4gIGRiOiB7XG4gICAgc2NoZW1hOiAncHVibGljJ1xuICB9LFxuICBnbG9iYWw6IHtcbiAgICBoZWFkZXJzOiB7ICd4LW15LWN1c3RvbS1oZWFkZXInOiAnbXktYXBwLW5hbWUnIH1cbiAgfVxufSlcblxuZXhwb3J0IGludGVyZmFjZSBDYXJ0UmVjb3JkIHtcbiAgaWQ6IHN0cmluZ1xuICBjYXJ0X2lkOiBzdHJpbmdcbiAgdXNlcl9waG9uZT86IHN0cmluZ1xuICB1c2VyX2VtYWlsPzogc3RyaW5nXG4gIGNhcnRfdG9rZW46IHN0cmluZ1xuICBsaW5lX2l0ZW1zOiBhbnlbXVxuICBzdGF0dXM6ICdhY3RpdmUnIHwgJ2FiYW5kb25lZCcgfCAncmVjb3ZlcmVkJ1xuICBjYWxsX3NlbnQ6IGJvb2xlYW5cbiAgY3JlYXRlZF9hdDogc3RyaW5nXG4gIHVwZGF0ZWRfYXQ6IHN0cmluZ1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZUNhcnQoY2FydERhdGE6IGFueSkge1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdjYXJ0cycpXG4gICAgLnVwc2VydCh7XG4gICAgICBjYXJ0X2lkOiBjYXJ0RGF0YS5pZCxcbiAgICAgIHVzZXJfcGhvbmU6IGNhcnREYXRhLnBob25lLFxuICAgICAgdXNlcl9lbWFpbDogY2FydERhdGEuZW1haWwsXG4gICAgICBjYXJ0X3Rva2VuOiBjYXJ0RGF0YS50b2tlbixcbiAgICAgIGxpbmVfaXRlbXM6IGNhcnREYXRhLmxpbmVfaXRlbXMsXG4gICAgICBzdGF0dXM6ICdhY3RpdmUnLFxuICAgICAgY2FsbF9zZW50OiBmYWxzZSxcbiAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH0pXG4gICAgLnNlbGVjdCgpXG5cbiAgaWYgKGVycm9yKSB0aHJvdyBlcnJvclxuICByZXR1cm4gZGF0YVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWFya0NhcnRBYmFuZG9uZWQoY2FydElkOiBzdHJpbmcpIHtcbiAgY29uc3QgeyBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnY2FydHMnKVxuICAgIC51cGRhdGUoeyBzdGF0dXM6ICdhYmFuZG9uZWQnIH0pXG4gICAgLmVxKCdjYXJ0X2lkJywgY2FydElkKVxuXG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3Jcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1hcmtDYWxsU2VudChjYXJ0SWQ6IHN0cmluZykge1xuICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdjYXJ0cycpXG4gICAgLnVwZGF0ZSh7IGNhbGxfc2VudDogdHJ1ZSB9KVxuICAgIC5lcSgnY2FydF9pZCcsIGNhcnRJZClcblxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlV2ViaG9va0NhbGwodG9waWM6IHN0cmluZywgcGF5bG9hZDogYW55LCBoZWFkZXJzOiBhbnkpIHtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAuZnJvbSgnd2ViaG9va19jYWxscycpXG4gICAgLmluc2VydCh7XG4gICAgICB0b3BpYyxcbiAgICAgIHBheWxvYWQsXG4gICAgICBoZWFkZXJzLFxuICAgICAgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgfSlcbiAgICAuc2VsZWN0KClcblxuICBpZiAoZXJyb3IpIHRocm93IGVycm9yXG4gIHJldHVybiBkYXRhXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTdGF0cygpIHtcbiAgLy8gUmV0dXJuIG1vY2sgZGF0YSBpZiBTdXBhYmFzZSBub3QgY29uZmlndXJlZFxuICBpZiAoIXByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCAhcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkpIHtcbiAgICByZXR1cm4geyB0b3RhbENhcnRzOiA4LCBhYmFuZG9uZWRDYXJ0czogNCwgY2FsbHNTZW50OiA0LCByZWNvdmVyeVJhdGU6IDEwMCB9XG4gIH1cblxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdjYXJ0cycpXG4gICAgLnNlbGVjdCgnc3RhdHVzLCBjYWxsX3NlbnQnKVxuXG4gIGlmIChlcnJvcikgdGhyb3cgZXJyb3JcblxuICBjb25zdCB0b3RhbENhcnRzID0gZGF0YS5sZW5ndGhcbiAgY29uc3QgYWJhbmRvbmVkQ2FydHMgPSBkYXRhLmZpbHRlcigoY2FydDogYW55KSA9PiBjYXJ0LnN0YXR1cyA9PT0gJ2FiYW5kb25lZCcpLmxlbmd0aFxuICBjb25zdCBjYWxsc1NlbnQgPSBkYXRhLmZpbHRlcigoY2FydDogYW55KSA9PiBjYXJ0LmNhbGxfc2VudCkubGVuZ3RoXG4gIGNvbnN0IHJlY292ZXJ5UmF0ZSA9IGFiYW5kb25lZENhcnRzID4gMCA/IE1hdGgucm91bmQoKGNhbGxzU2VudCAvIGFiYW5kb25lZENhcnRzKSAqIDEwMCkgOiAwXG5cbiAgcmV0dXJuIHsgdG90YWxDYXJ0cywgYWJhbmRvbmVkQ2FydHMsIGNhbGxzU2VudCwgcmVjb3ZlcnlSYXRlIH1cbn0iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VLZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInN1cGFiYXNlIiwiYXV0aCIsInBlcnNpc3RTZXNzaW9uIiwiZGIiLCJzY2hlbWEiLCJnbG9iYWwiLCJoZWFkZXJzIiwic2F2ZUNhcnQiLCJjYXJ0RGF0YSIsImRhdGEiLCJlcnJvciIsImZyb20iLCJ1cHNlcnQiLCJjYXJ0X2lkIiwiaWQiLCJ1c2VyX3Bob25lIiwicGhvbmUiLCJ1c2VyX2VtYWlsIiwiZW1haWwiLCJjYXJ0X3Rva2VuIiwidG9rZW4iLCJsaW5lX2l0ZW1zIiwic3RhdHVzIiwiY2FsbF9zZW50IiwidXBkYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNlbGVjdCIsIm1hcmtDYXJ0QWJhbmRvbmVkIiwiY2FydElkIiwidXBkYXRlIiwiZXEiLCJtYXJrQ2FsbFNlbnQiLCJzYXZlV2ViaG9va0NhbGwiLCJ0b3BpYyIsInBheWxvYWQiLCJpbnNlcnQiLCJjcmVhdGVkX2F0IiwiZ2V0U3RhdHMiLCJ0b3RhbENhcnRzIiwiYWJhbmRvbmVkQ2FydHMiLCJjYWxsc1NlbnQiLCJyZWNvdmVyeVJhdGUiLCJsZW5ndGgiLCJmaWx0ZXIiLCJjYXJ0IiwiTWF0aCIsInJvdW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/vapi.ts":
/*!*************************!*\
  !*** ./src/lib/vapi.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VapiService: () => (/* binding */ VapiService),\n/* harmony export */   vapiService: () => (/* binding */ vapiService)\n/* harmony export */ });\nclass VapiService {\n    constructor(){\n        this.baseUrl = \"https://api.vapi.ai\";\n        this.apiKey = process.env.VAPI_API_KEY;\n        if (!this.apiKey) {\n            throw new Error(\"VAPI_API_KEY is required\");\n        }\n    }\n    async makeCall(customerPhone, customerName = \"Customer\", productName = \"Product\") {\n        try {\n            const callRequest = {\n                assistantId: process.env.VAPI_ASSISTANT_ID,\n                phoneNumber: {\n                    twilioPhoneNumber: process.env.VAPI_TWILIO_PHONE_NUMBER,\n                    twilioAccountSid: process.env.VAPI_TWILIO_ACCOUNT_SID,\n                    twilioAuthToken: process.env.VAPI_TWILIO_AUTH_TOKEN\n                },\n                customer: {\n                    number: customerPhone\n                },\n                assistantOverrides: {\n                    variableValues: {\n                        customerName,\n                        productName\n                    }\n                }\n            };\n            const response = await fetch(`${this.baseUrl}/call/phone`, {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Bearer ${this.apiKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(callRequest)\n            });\n            const data = await response.json();\n            if (!response.ok) {\n                return {\n                    success: false,\n                    error: data.message || \"Failed to make call\"\n                };\n            }\n            return {\n                success: true,\n                callId: data.id\n            };\n        } catch (error) {\n            console.error(\"VAPI call error:\", error);\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            };\n        }\n    }\n}\nconst vapiService = new VapiService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ZhcGkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUF3Qk8sTUFBTUE7SUFJWEMsYUFBYzthQUZOQyxVQUFVO1FBR2hCLElBQUksQ0FBQ0MsTUFBTSxHQUFHQyxRQUFRQyxHQUFHLENBQUNDLFlBQVk7UUFDdEMsSUFBSSxDQUFDLElBQUksQ0FBQ0gsTUFBTSxFQUFFO1lBQ2hCLE1BQU0sSUFBSUksTUFBTTtRQUNsQjtJQUNGO0lBRUEsTUFBTUMsU0FDSkMsYUFBcUIsRUFDckJDLGVBQXVCLFVBQVUsRUFDakNDLGNBQXNCLFNBQVMsRUFDSjtRQUMzQixJQUFJO1lBQ0YsTUFBTUMsY0FBK0I7Z0JBQ25DQyxhQUFhVCxRQUFRQyxHQUFHLENBQUNTLGlCQUFpQjtnQkFDMUNDLGFBQWE7b0JBQ1hDLG1CQUFtQlosUUFBUUMsR0FBRyxDQUFDWSx3QkFBd0I7b0JBQ3ZEQyxrQkFBa0JkLFFBQVFDLEdBQUcsQ0FBQ2MsdUJBQXVCO29CQUNyREMsaUJBQWlCaEIsUUFBUUMsR0FBRyxDQUFDZ0Isc0JBQXNCO2dCQUNyRDtnQkFDQUMsVUFBVTtvQkFDUkMsUUFBUWQ7Z0JBQ1Y7Z0JBQ0FlLG9CQUFvQjtvQkFDbEJDLGdCQUFnQjt3QkFDZGY7d0JBQ0FDO29CQUNGO2dCQUNGO1lBQ0Y7WUFFQSxNQUFNZSxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQ3pCLE9BQU8sQ0FBQyxXQUFXLENBQUMsRUFBRTtnQkFDekQwQixRQUFRO2dCQUNSQyxTQUFTO29CQUNQLGlCQUFpQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMxQixNQUFNLENBQUMsQ0FBQztvQkFDeEMsZ0JBQWdCO2dCQUNsQjtnQkFDQTJCLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQ3BCO1lBQ3ZCO1lBRUEsTUFBTXFCLE9BQU8sTUFBTVAsU0FBU1EsSUFBSTtZQUVoQyxJQUFJLENBQUNSLFNBQVNTLEVBQUUsRUFBRTtnQkFDaEIsT0FBTztvQkFDTEMsU0FBUztvQkFDVEMsT0FBT0osS0FBS0ssT0FBTyxJQUFJO2dCQUN6QjtZQUNGO1lBRUEsT0FBTztnQkFDTEYsU0FBUztnQkFDVEcsUUFBUU4sS0FBS08sRUFBRTtZQUNqQjtRQUNGLEVBQUUsT0FBT0gsT0FBTztZQUNkSSxRQUFRSixLQUFLLENBQUMsb0JBQW9CQTtZQUNsQyxPQUFPO2dCQUNMRCxTQUFTO2dCQUNUQyxPQUFPQSxpQkFBaUI5QixRQUFROEIsTUFBTUMsT0FBTyxHQUFHO1lBQ2xEO1FBQ0Y7SUFDRjtBQUNGO0FBRU8sTUFBTUksY0FBYyxJQUFJMUMsY0FBYyIsInNvdXJjZXMiOlsid2VicGFjazovL3Nob3BpZnktY2FydC1yZWNvdmVyeS8uL3NyYy9saWIvdmFwaS50cz9lYzNhIl0sInNvdXJjZXNDb250ZW50IjpbImludGVyZmFjZSBWYXBpQ2FsbFJlcXVlc3Qge1xuICBhc3Npc3RhbnRJZDogc3RyaW5nO1xuICBwaG9uZU51bWJlcjoge1xuICAgIHR3aWxpb1Bob25lTnVtYmVyOiBzdHJpbmc7XG4gICAgdHdpbGlvQWNjb3VudFNpZDogc3RyaW5nO1xuICAgIHR3aWxpb0F1dGhUb2tlbjogc3RyaW5nO1xuICB9O1xuICBjdXN0b21lcjoge1xuICAgIG51bWJlcjogc3RyaW5nO1xuICB9O1xuICBhc3Npc3RhbnRPdmVycmlkZXM6IHtcbiAgICB2YXJpYWJsZVZhbHVlczoge1xuICAgICAgY3VzdG9tZXJOYW1lOiBzdHJpbmc7XG4gICAgICBwcm9kdWN0TmFtZTogc3RyaW5nO1xuICAgIH07XG4gIH07XG59XG5cbmludGVyZmFjZSBWYXBpQ2FsbFJlc3BvbnNlIHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgY2FsbElkPzogc3RyaW5nO1xuICBlcnJvcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFZhcGlTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBhcGlLZXk6IHN0cmluZztcbiAgcHJpdmF0ZSBiYXNlVXJsID0gJ2h0dHBzOi8vYXBpLnZhcGkuYWknO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYXBpS2V5ID0gcHJvY2Vzcy5lbnYuVkFQSV9BUElfS0VZITtcbiAgICBpZiAoIXRoaXMuYXBpS2V5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1ZBUElfQVBJX0tFWSBpcyByZXF1aXJlZCcpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIG1ha2VDYWxsKFxuICAgIGN1c3RvbWVyUGhvbmU6IHN0cmluZyxcbiAgICBjdXN0b21lck5hbWU6IHN0cmluZyA9ICdDdXN0b21lcicsXG4gICAgcHJvZHVjdE5hbWU6IHN0cmluZyA9ICdQcm9kdWN0J1xuICApOiBQcm9taXNlPFZhcGlDYWxsUmVzcG9uc2U+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FsbFJlcXVlc3Q6IFZhcGlDYWxsUmVxdWVzdCA9IHtcbiAgICAgICAgYXNzaXN0YW50SWQ6IHByb2Nlc3MuZW52LlZBUElfQVNTSVNUQU5UX0lEISxcbiAgICAgICAgcGhvbmVOdW1iZXI6IHtcbiAgICAgICAgICB0d2lsaW9QaG9uZU51bWJlcjogcHJvY2Vzcy5lbnYuVkFQSV9UV0lMSU9fUEhPTkVfTlVNQkVSISxcbiAgICAgICAgICB0d2lsaW9BY2NvdW50U2lkOiBwcm9jZXNzLmVudi5WQVBJX1RXSUxJT19BQ0NPVU5UX1NJRCEsXG4gICAgICAgICAgdHdpbGlvQXV0aFRva2VuOiBwcm9jZXNzLmVudi5WQVBJX1RXSUxJT19BVVRIX1RPS0VOISxcbiAgICAgICAgfSxcbiAgICAgICAgY3VzdG9tZXI6IHtcbiAgICAgICAgICBudW1iZXI6IGN1c3RvbWVyUGhvbmUsXG4gICAgICAgIH0sXG4gICAgICAgIGFzc2lzdGFudE92ZXJyaWRlczoge1xuICAgICAgICAgIHZhcmlhYmxlVmFsdWVzOiB7XG4gICAgICAgICAgICBjdXN0b21lck5hbWUsXG4gICAgICAgICAgICBwcm9kdWN0TmFtZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhbGwvcGhvbmVgLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShjYWxsUmVxdWVzdCksXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBkYXRhLm1lc3NhZ2UgfHwgJ0ZhaWxlZCB0byBtYWtlIGNhbGwnLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBjYWxsSWQ6IGRhdGEuaWQsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdWQVBJIGNhbGwgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH07XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCB2YXBpU2VydmljZSA9IG5ldyBWYXBpU2VydmljZSgpOyJdLCJuYW1lcyI6WyJWYXBpU2VydmljZSIsImNvbnN0cnVjdG9yIiwiYmFzZVVybCIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJWQVBJX0FQSV9LRVkiLCJFcnJvciIsIm1ha2VDYWxsIiwiY3VzdG9tZXJQaG9uZSIsImN1c3RvbWVyTmFtZSIsInByb2R1Y3ROYW1lIiwiY2FsbFJlcXVlc3QiLCJhc3Npc3RhbnRJZCIsIlZBUElfQVNTSVNUQU5UX0lEIiwicGhvbmVOdW1iZXIiLCJ0d2lsaW9QaG9uZU51bWJlciIsIlZBUElfVFdJTElPX1BIT05FX05VTUJFUiIsInR3aWxpb0FjY291bnRTaWQiLCJWQVBJX1RXSUxJT19BQ0NPVU5UX1NJRCIsInR3aWxpb0F1dGhUb2tlbiIsIlZBUElfVFdJTElPX0FVVEhfVE9LRU4iLCJjdXN0b21lciIsIm51bWJlciIsImFzc2lzdGFudE92ZXJyaWRlcyIsInZhcmlhYmxlVmFsdWVzIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImRhdGEiLCJqc29uIiwib2siLCJzdWNjZXNzIiwiZXJyb3IiLCJtZXNzYWdlIiwiY2FsbElkIiwiaWQiLCJjb25zb2xlIiwidmFwaVNlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/vapi.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.0.0_react-dom@18.3.1_react@18.3.1__react@18.3.1","vendor-chunks/axios@1.13.2","vendor-chunks/@supabase+storage-js@2.87.1","vendor-chunks/@supabase+auth-js@2.87.1","vendor-chunks/@supabase+realtime-js@2.87.1","vendor-chunks/asynckit@0.4.0","vendor-chunks/math-intrinsics@1.1.0","vendor-chunks/@supabase+supabase-js@2.87.1","vendor-chunks/es-errors@1.3.0","vendor-chunks/@supabase+postgrest-js@2.87.1","vendor-chunks/call-bind-apply-helpers@1.0.2","vendor-chunks/@supabase+functions-js@2.87.1","vendor-chunks/get-proto@1.0.1","vendor-chunks/mime-db@1.52.0","vendor-chunks/has-symbols@1.1.0","vendor-chunks/gopd@1.2.0","vendor-chunks/function-bind@1.1.2","vendor-chunks/form-data@4.0.5","vendor-chunks/follow-redirects@1.15.11","vendor-chunks/tslib@2.8.1","vendor-chunks/iceberg-js@0.8.1","vendor-chunks/proxy-from-env@1.1.0","vendor-chunks/mime-types@2.1.35","vendor-chunks/hasown@2.0.2","vendor-chunks/has-tostringtag@1.0.2","vendor-chunks/get-intrinsic@1.3.0","vendor-chunks/es-set-tostringtag@2.1.0","vendor-chunks/es-object-atoms@1.1.1","vendor-chunks/es-define-property@1.0.1","vendor-chunks/dunder-proto@1.0.1","vendor-chunks/delayed-stream@1.0.0","vendor-chunks/combined-stream@1.0.8"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.0.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Froute&page=%2Fapi%2Fwebhook%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Froute.ts&appDir=%2FApplications%2FMAMP%2Fhtdocs%2Fshopify-cart-recovery%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FApplications%2FMAMP%2Fhtdocs%2Fshopify-cart-recovery&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();